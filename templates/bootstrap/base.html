{% extends "base_sub.html" %}

{% block body_html %}
<!-- 상단 시작 { -->
<header id="hd" class="container-fluid wrapper-bg py-4 sticky-top primary-bb">
  <div id="skip_to_container"><a href="#container">본문 바로가기</a></div>

  {% include "/bbs/newwin.inc.html" %}


  <div id="hd_wrapper" class="container-xxl d-flex justify-content-between align-items-center">
    <div id="logo">
      <a href="/"><img src="/static/img/logo_new2.png" width="48" height="48" alt="그누보드6"></a>
    </div>
    <!-- 메뉴 -->
    <nav id="gnb">
      <h2 class="blind">메인메뉴</h2>
      <div>
        {% include "/bbs/menu.html" ignore missing %}
      </div>
    </nav>
    <button type="button" id="gnb_open" class="d-block d-md-none text-white">
      <i class="fa fa-bars" aria-hidden="true"></i>
      <span class="blind">열기</span>
    </button>
    <div id="gnb_mo" class="gnb_mo">
    <button type="button" id="gnb_close" class="hhd_defined_closer">
      <span class="blind">메뉴 닫기</span>
      <i class="fa fa-xmark" aria-hidden="true"></i>
    </button>
      <!-- 아웃 로그인 -->
      {% if request.state.login_member %}
      {% include "mobile/bbs/outlogin_after.html" ignore missing %}
      {% else %}
      {% include "mobile/bbs/outlogin_before.html" ignore missing %}
      {% endif %}

      <!-- 메뉴 -->
      {% include "mobile/bbs/menu.html" ignore missing %}

      <ul id="hd_nb">
        <li class="hd_nb1">
          <a href="/bbs/faq" id="snb_faq">
            <i class="fa fa-question" aria-hidden="true"></i>FAQ
          </a>
        </li>
        <li class="hd_nb2">
          <a href="/bbs/qalist" id="snb_qa">
            <i class="fa fa-comments" aria-hidden="true"></i>1:1문의
          </a>
        </li>
        <li class="hd_nb3">
          <a href="/bbs/current_connect" id="snb_cnt">
            <i class="fa fa-users" aria-hidden="true"></i>접속자
            <span>{{ current_login_count[0]|number_format }}</span>
          </a>
        </li>
        <li class="hd_nb4">
          <a href="/bbs/new" id="snb_new">
            <i class="fa fa-history" aria-hidden="true"></i>새글
          </a>
        </li>
      </ul>
    </div>
    <script>
      var gnb_opener = document.querySelector("#gnb_open");
      var sch_opener = document.querySelector("#user_btn");
      var close_btn = document.querySelector("#gnb_close");
      var hd_sch_wr = document.querySelector(".hd_sch_wr");
      var hd_gnb_wr = document.querySelector("#gnb_mo");

      function handleSearchClick() {
        hd_sch_wr.classList.toggle("active");
      }

      function handleGnbClick() {
        hd_gnb_wr.classList.add("active");
      }

      function delGnbClick() {
        hd_gnb_wr.classList.remove("active");
      }

      sch_opener.addEventListener("click", handleSearchClick);
      gnb_opener.addEventListener("click", handleGnbClick);
      close_btn.addEventListener("click", delGnbClick);
    </script>

    <div id="util_box" class="d-flex">
      <!-- 검색 버튼 -->
      <button type="button" id="user_btn" class="rounded-circle overflow-hidden border-0 bg-transparent fs-3 main-font me-3" style="width: 48px; height: 48px;">
        <i class="fa fa-search" aria-hidden="true"></i>
        <span class="blind">사용자메뉴</span>
      </button>
      <!-- 다크모드 버튼 -->
      <button type="button" id="darkmode-toggle-switch" class="rounded-circle overflow-hidden border-0 bg-transparent fs-4 main-font me-3" style="width: 48px; height: 48px;">
        <i class="fa-solid fa-regular fa-moon visible bright"></i>
        <i class="fa-solid fa-regular fa-sun visible dark"></i>
      </button>
      <!-- 프로필 -->
      <div id="profile" class="dropdown d-none d-md-block bg-transparent">
        <span id="profileDropdown" data-bs-toggle="dropdown" aria-expanded="false" class="d-inline-block rounded-circle overflow-hidden cursor-pointer" style="width: 48px; height: 48px;" tabindex="0">
          <img src="{{ get_member_image(request, request.state.login_member.mb_id)|safe }}" style="width: 100%;" alt="profile_image">
        </span>
        <div class="dropdown-menu cont-bg" aria-labelledby="profileDropdown">
          {% if request.state.login_member %}
          {% include "bbs/outlogin_after.html" %}
          {% else %}
          {% include "bbs/outlogin_before.html" %}
          {% endif %}
          {% if menus -%}
          {%- endif %}
        </div>
      </div>
    </div> 
  </div>

  <!-- 프로필 이미지 클릭 이벤트 -->
  <script>
    var profileImg = document.querySelector("#profile");
    var mypageBox = document.querySelector(".hd_login");

    function handleProfileClick() {
      mypageBox.classList.add("active");
    }

    function handleProfileFocusout() {
      mypageBox.classList.remove("active");
    }

    profileImg.addEventListener("click", handleProfileClick);
    profileImg.addEventListener("focusout", handleProfileFocusout);
  </script>

</header>
<!-- } 상단 끝 -->

{% if errors %}
<ul>
  {% for error in errors %}
  <li>{{ error }}</li>
  {% endfor %}
</ul>
{% endif %}

<hr>

<!-- 콘텐츠 시작 { -->
<div id="wrapper" class="container-xxl pt-5">
  <div id="container_wr" class="row">
    <div id="container" class="col-9">
      <h2 id="container_title" class="m-0"><span>{% block subtitle %}{% endblock subtitle %}</span></h2>
      {% block content %}
      {% endblock content %}
    </div>
    <div id="aside" class="col-3">

      <!-- 설문조사 -->
      {% include "/bbs/poll.html" %}

      <!-- 공지사항 -->
      {{ render_latest_posts(request, 'main_notice', 'notice', 4, 23)|safe }}

      <!-- 접속자집계 { -->
      {% if render_visit_statistics %}
      {{ render_visit_statistics(request)|safe }}
      {% endif %}

      <script>
        // aside/최신글 - 탭메뉴 기능
        var tabItems = document.querySelectorAll('.aside_tab ul.tab_01 li');

        tabItems.forEach(function (item) {
          item.addEventListener('click', function () {
            var asideTabId = this.getAttribute('data-tab');

            // Remove 'current' class from all tab items and content elements
            tabItems.forEach(function (tabItem) {
              tabItem.classList.remove('current');
            });

            var contentElements = document.querySelectorAll('.aside_tab .content01');
            contentElements.forEach(function (contentElement) {
              contentElement.classList.remove('current');
            });

            // Add 'current' class to the clicked tab item and corresponding content element
            this.classList.add('current');
            document.getElementById(asideTabId).classList.add('current');
          });
        });
      </script>
    </div>
  </div>
</div>
<!-- } 콘텐츠 끝 -->


<hr>

<!-- 하단 시작 { -->
<div id="ft">

  <div id="ft_wr" class="container-xl">
    <div id="ft_link" class="ft_cnt">
      <a href="{{ url_for('content_view', co_id='company') }}">회사소개</a>
      <a href="{{ url_for('content_view', co_id='privacy') }}">개인정보처리방침</a>
      <a href="{{ url_for('content_view', co_id='provision') }}">서비스이용약관</a>
      {% if not request.state.is_responsive %}
      {% if request.state.is_mobile %}
      <a href="{{ url_for('device_change', device='pc') }}">PC버전</a>
      {% else %}
      <a href="{{ url_for('device_change', device='mobile') }}">모바일버전</a>
      {% endif %}
      {% endif %}
    </div>
    <div id="ft_company" class="ft_cnt">

    </div>
  </div>
  <div id="ft_copy">Copyright &copy; <b>{{ request.url.hostname }}.</b> All rights reserved.</div>

  <button type="button" id="top_btn">
    <i class="fa fa-arrow-up" aria-hidden="true"></i><span class="blind">상단으로</span>
  </button>
</div>

{% if request.state.config.cf_analytics %}
{{ request.state.config.cf_analytics|safe }}
{% endif %}

<!-- } 하단 끝 -->

<script>
  // 상단 스크롤 버튼
  $(function () {
    $("#top_btn").on("click", function () {
      $("html, body").animate({
        scrollTop: 0
      }, '500');
      return false;
    });
  });
</script>
{% endblock body_html %}